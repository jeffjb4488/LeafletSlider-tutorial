<html lang="en">
    <head>
        <!--jquery js-->
        <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>

        <!--jQuery UI files-->
        <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" />
        <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js" integrity="sha256-T0Vest3yCU7pafRw9r+settMBX6JkKN06dqBnpQ8d30=" crossorigin="anonymous"></script>

        <!--jQuery UI Touch js, required for touchscreen use-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>

        <!-- leaflet files -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js"></script>

        <!--Leaflet Time-Slider module js;
        find maintained version at https://github.com/geyerbri/LeafletSlider-->
        <script src="js/SliderControl.js"></script>

        
        <style>
            body {
                margin: 0;
                background-color: black;
            }
        	#myMap {
                /*height: 100%;
                width: 100%;*/
        		width: 800px;
                max-width: 100%;
                height: 450px;
                margin: 0;
                position: absolute;
                top: 50%;
                left: 50%;
                -ms-transform: translate(-50%, -50%);
                transform: translate(-50%, -50%)
        	}
        </style>

        <title>LeafletSlider Tutorial</title>
    </head>
    <body>
        <!--Create the map div container-->
        <div id="myMap">Test this text.</div>
        <script>

            // Start with geoJSON data
                       var dataset1 = [
                {
                    type: 'Feature',
		    geometry: {
                        type: 'Point',
                        coordinates: [-70.56813705004735, 41.46150888423962]
		
                    },
                    properties: {
                        Lot_Number: 'Frandor Deli',
                        Grantee: '<a href="https://frandordeli.weebly.com/">Frandor Deli</a> closed permanently the week of May 18, 2020 due to the COVID-19 pandemic. According to the Lansing State Journal, Frandor Deli had been open for 38 years.',
                        time: '2020/05/18',
                        image: 'html/Frandor_deli.jpg',
                        icon: {
                            iconUrl: 'html/restauranticon.png',
                            iconSize: [25, 41],
                            iconAnchor: [3, 35],
                            popupAnchor: [0, -41],
                            className: 'dot',
                        }
			
                    }
		
                },
                {
                    type: 'Feature',
                    geometry: {
                        type: 'Point',
                        coordinates: [-70.55978282699071, 41.46299628120155] 
                    },
                    properties: {
                        Lot_Numner: "Mijo's Diner",
                        Grantee: 'On March 23, 2021, the owners of <a href="https://www.facebook.com/MijosDiner/">Mijo’s Diner</a> posted their final message to their customers on the business’s Facebook page: “To all our customers: Carole and I (Tony) want to thank you for your support of the diner over the last 21 years and other Mijo’s restaurants starting all the way back in 1976. We have made the decision to close the doors permanently. This was a difficult choice, but we believe it was the right decision given both the current situation and thinking about the future for Carole and myself. We hope you all continue to support other local businesses. We wish you all good health and thank you all for the memories. Sincerely, Carole and Tony"',
                        time: '2020/03/23',
                        image: 'html/Mijos_diner.jpeg',
                        icon: {
                            iconUrl: 'html/restauranticon.png',
                            iconSize: [25, 41],
                            iconAnchor: [3, 35],
                            popupAnchor: [0, -41],
                            className: 'dot',
                        }
                    }
                },
                 {
                    type: 'Feature',
                    geometry: {
                        type: 'Point',
                        coordinates: [-70.56254350973987, 41.458168877604066]
                    },
                    properties: {
                        Lot_Number: 'Fireside Grill',
                        Grantee: 'The owners of the <a href="https://www.facebook.com/FiresideGrill6951/">Fireside Grill</a> announced on March 16, 2021 that they would be closing indefinitely due to the COVID-19. A few months later on June 17, 2021, in a series of Facebook posts the restaurant thanked its customers for their support over the last seven years and announced the permanent closure of the restaurant. In an interview with the Lansing State Journal, owner Ed Hall expressed the difficulty owners of restaurants faced during the pandemic: "You’ve got to have a lot of money to weather a sustained shutdown....You’ve got to have deep pockets. You really do.”',
                        time: '2020/06/17',
                        image: 'html/Fireside_grill.jpg',
                        icon: {
                            iconUrl: 'html/restauranticon.png',
                            iconSize: [25, 41],
                            iconAnchor: [3, 35],
                            popupAnchor: [0, -41],
                            className: 'dot',
                        }
                    }
                },
                {
                    type: 'Feature',
                    geometry: {
                        type: 'Point',
                        coordinates: [-70.56366221778202, 41.45954817244251]
                    },
                    properties: {
                        Lot_Number: 'The Brunch House',
                        Grantee: 'While Leo Farhat was planning to retire within the next five years, he didn’t anticipate that the decision would be abruptly made for him in Spring 2020. <a href="https://www.lansingstatejournal.com/story/news/local/2020/05/27/restaurants-that-have-closed-permanently-in-lansing-mid-michigan-covid-19/5231525002/">He told the Lansing State Journal</a> that when Governor Gretchen Whitmer extended the stay at home order following the restaurant’s closure on March 16, he decided to officially close: “I just felt that it was going to be a long process. And so I called a staff meeting and informed them that I would be closing the restaurant. Unfortunately it’s gone on a lot longer, with so many questions about this pandemic, that I was pretty happy with the decision.”',
                        time: '2020/03/16',
                        image: 'html/The_brunch_house.jpg',
                        icon: {
                            iconUrl: 'html/restauranticon.png',
                            iconSize: [25, 41],
                            iconAnchor: [3, 35],
                            popupAnchor: [0, -41],
                            className: 'dot',
                        }
                    }
                };
		   ];

            // Generate the map and set its initial view
        	var map1 = L.map('myMap').setView([41.46091391587842, -70.56499744996137], 12);
            L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            }).addTo(map1);

            // Write up the functions for using the geoJSON data to produce popups for each marker
            var optionsObject = {
                onEachFeature: onEachFeature
            };
            function onEachFeature (feature, layer) {
                var content = "<div style='clear: both'></div><div><h4>" + feature.properties.title + "</h4><p>" + feature.properties.time + "</p><p>" + feature.properties.description + "</p></div>";
                layer.bindPopup(content, {closeButton: true});
            };

            // Create the first geoJSON layer
            var group1 = L.geoJSON(dataset1, optionsObject);

            // Create the second geoJSON layer from external file
            $.getJSON("data/popups.json", function(json) {
                var group2 = L.geoJSON(json, optionsObject);

            // Set the time attribute for each group
            group1.options.time = "1992";
            group2.options.time = "1993";

            // Create the layerGroup
            var multiLayers = L.layerGroup([group1, group2]);

            // Set the sliderControl options
            var sliderControl1 = L.control.sliderControl( {
                layer: multiLayers, //REQUIRED
                alwaysShowDate: true,
                showAllPopups: false, // to show all popups, instead of one, same as popup option "autoClose: false"
                showPopups: false // to set it so, when a marker is generated by the slider, its popup doesn't automatically display
            });

            // Add the slider to the map
            map1.addControl(sliderControl1);

            // Initialize the slider
            sliderControl1.startSlider();
        });
        </script>
    </body>
</html>
